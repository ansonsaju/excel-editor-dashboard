<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Editor Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        *{font-family:'Inter',sans-serif;margin:0;padding:0;box-sizing:border-box}
        body{background:linear-gradient(135deg,#FFF8EB 0%,#F5EFE6 50%,#E8DCC8 100%);min-height:100vh}
        .glass{background:rgba(255,255,255,0.7);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px)}
        .btn-primary{background:linear-gradient(135deg,#6D776E,#D4A574);color:white;padding:12px 24px;border-radius:12px;border:none;cursor:pointer;font-weight:600;transition:all 0.3s}
        .btn-primary:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 8px 20px rgba(109,119,110,0.3)}
        .btn-primary:disabled{opacity:0.5;cursor:not-allowed}
        .btn-secondary{background:white;color:#6D776E;padding:12px 24px;border-radius:12px;border:2px solid #E8DCC8;cursor:pointer;font-weight:600;transition:all 0.3s}
        .btn-secondary:hover:not(:disabled){border-color:#D4A574;transform:translateY(-2px)}
        .btn-icon{background:white;color:#6D776E;padding:12px;border-radius:12px;border:2px solid #E8DCC8;cursor:pointer;transition:all 0.3s}
        .btn-icon:hover:not(:disabled){border-color:#D4A574}
        .btn-icon:disabled{opacity:0.5;cursor:not-allowed}
        input[type="text"],input[type="number"],select{width:100%;padding:10px 12px;border:2px solid #E8DCC8;border-radius:8px;background:rgba(255,255,255,0.8);outline:none;transition:all 0.3s}
        input:focus,select:focus{border-color:#D4A574;box-shadow:0 0 0 3px rgba(212,165,116,0.1)}
        .suggestion-box{position:absolute;z-index:999;width:100%;margin-top:4px;background:white;border:2px solid #D4A574;border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,0.15);max-height:250px;overflow-y:auto}
        .suggestion-item{padding:10px 12px;cursor:pointer;border-bottom:1px solid #E8DCC8;display:flex;justify-content:space-between;align-items:center;transition:all 0.2s}
        .suggestion-item:hover{background:#FFF8EB;padding-left:16px}
        .suggestion-item:last-child{border-bottom:none}
        .badge{font-size:10px;padding:3px 8px;border-radius:12px;font-weight:700}
        .badge-common{background:#D4A574;color:white}
        .badge-recent{background:#6D776E;color:white}
        .badge-stat{background:#3b82f6;color:white}
        .badge-range{background:#E8DCC8;color:#6D776E}
        table{width:100%;border-collapse:collapse}
        thead{background:linear-gradient(135deg,#6D776E,#D4A574);color:white;position:sticky;top:0;z-index:10}
        th,td{padding:12px;text-align:left;border-bottom:1px solid #E8DCC8}
        tbody tr:hover{background:rgba(255,248,235,0.5)}
        .hidden{display:none!important}
        .toast{position:fixed;top:24px;right:24px;z-index:9999;padding:12px 24px;border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,0.2);animation:slideIn 0.3s ease-out;min-width:250px}
        .toast-success{background:linear-gradient(135deg,#10b981,#059669);color:white}
        .toast-error{background:linear-gradient(135deg,#ef4444,#dc2626);color:white}
        @keyframes slideIn{from{transform:translateX(400px);opacity:0}to{transform:translateX(0);opacity:1}}
        @keyframes pulse{0%,100%{opacity:1}50%{opacity:0.5}}
        .pulse{animation:pulse 2s infinite}
        *::-webkit-scrollbar{width:10px;height:10px}
        *::-webkit-scrollbar-track{background:#E8DCC8;border-radius:5px}
        *::-webkit-scrollbar-thumb{background:linear-gradient(135deg,#6D776E,#D4A574);border-radius:5px}
        .view-toggle{display:inline-flex;background:rgba(255,255,255,0.8);border-radius:12px;padding:4px;border:1px solid #E8DCC8}
        .view-toggle button{padding:8px 16px;border-radius:8px;border:none;background:transparent;color:#6D776E;cursor:pointer;font-weight:600;transition:all 0.2s}
        .view-toggle button.active{background:linear-gradient(135deg,#6D776E,#D4A574);color:white;box-shadow:0 2px 8px rgba(109,119,110,0.3)}
    </style>
</head>
<body>
    <div style="min-height:100vh;padding:16px;position:relative">
        <!-- Toast Container -->
        <div id="toastContainer"></div>

        <!-- Background Decoration -->
        <div style="position:fixed;top:40px;right:40px;opacity:0.05;pointer-events:none">
            <svg width="200" height="200" viewBox="0 0 200 200">
                <circle cx="100" cy="40" r="35" fill="#D4A574"/>
                <path d="M30,120 Q50,80 70,120 T110,120 T150,120" stroke="#6D776E" stroke-width="3" fill="none"/>
                <rect x="80" y="80" width="40" height="60" fill="#2C3E2F"/>
                <rect x="85" y="95" width="30" height="20" fill="#FFF8EB"/>
            </svg>
        </div>

        <div style="max-width:1400px;margin:0 auto">
            <!-- Header -->
            <div class="glass" style="border-radius:16px;box-shadow:0 8px 32px rgba(0,0,0,0.1);padding:24px;margin-bottom:24px;border:1px solid rgba(232,220,200,0.5)">
                <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:16px;margin-bottom:24px">
                    <div style="display:flex;align-items:center;gap:16px">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#D4A574" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2"/>
                            <line x1="9" y1="3" x2="9" y2="21"/>
                            <line x1="15" y1="3" x2="15" y2="21"/>
                            <line x1="3" y1="9" x2="21" y2="9"/>
                            <line x1="3" y1="15" x2="21" y2="15"/>
                        </svg>
                        <div>
                            <h1 style="font-size:32px;font-weight:800;background:linear-gradient(135deg,#6D776E,#D4A574);-webkit-background-clip:text;-webkit-text-fill-color:transparent">Excel Editor Pro</h1>
                            <p style="color:#6D776E;font-weight:500">Professional Data Management System</p>
                        </div>
                    </div>
                    <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap">
                        <label style="display:flex;align-items:center;gap:8px;padding:8px 16px;background:rgba(255,255,255,0.6);border-radius:8px;border:1px solid #E8DCC8;cursor:pointer">
                            <input type="checkbox" id="autoSave" checked style="accent-color:#D4A574">
                            <span style="font-size:14px;font-weight:500;color:#2C3E2F">Auto-save</span>
                        </label>
                        <div class="view-toggle">
                            <button id="tableViewBtn" class="active">
                                <svg style="display:inline-block;width:16px;height:16px;margin-right:4px" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/>
                                    <rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/>
                                </svg>
                                Table
                            </button>
                            <button id="cardViewBtn">
                                <svg style="display:inline-block;width:16px;height:16px;margin-right:4px" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="2" y="3" width="20" height="18" rx="2"/>
                                    <line x1="2" y1="9" x2="22" y2="9"/>
                                </svg>
                                Card
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div style="display:flex;flex-wrap:wrap;gap:12px">
                    <input type="file" id="fileInput" accept=".xlsx,.xls" style="display:none">
                    <button id="uploadBtn" class="btn-primary">
                        <svg style="display:inline-block;width:20px;height:20px;margin-right:8px" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"/>
                        </svg>
                        Upload File
                    </button>
                    <button id="downloadBtn" class="btn-secondary" disabled>
                        <svg style="display:inline-block;width:20px;height:20px;margin-right:8px" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/>
                        </svg>
                        Download
                    </button>
                    <button id="undoBtn" class="btn-icon" disabled title="Undo (Ctrl+Z)">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 7v6h6M21 17a9 9 0 00-9-9 9 9 0 00-9 9"/>
                        </svg>
                    </button>
                    <button id="redoBtn" class="btn-icon" disabled title="Redo (Ctrl+Y)">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 7v6h-6M3 17a9 9 0 019-9 9 9 0 019 9"/>
                        </svg>
                    </button>
                    <button id="addRowBtn" class="btn-primary" disabled>
                        <svg style="display:inline-block;width:20px;height:20px;margin-right:8px" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
                        </svg>
                        Add Row
                    </button>
                    <button id="historyBtn" class="btn-secondary">
                        <svg style="display:inline-block;width:20px;height:20px;margin-right:8px" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 3v5h5M3.05 13A9 9 0 1 0 6 5.3L3 8"/>
                        </svg>
                        Files
                    </button>
                </div>
            </div>

            <!-- Search & Filters -->
            <div id="filterSection" class="glass hidden" style="border-radius:16px;box-shadow:0 8px 32px rgba(0,0,0,0.1);padding:16px;margin-bottom:24px;border:1px solid rgba(232,220,200,0.5)">
                <div style="position:relative;margin-bottom:16px">
                    <svg style="position:absolute;left:12px;top:12px;width:20px;height:20px;color:#D4A574" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
                    </svg>
                    <input type="text" id="globalSearch" placeholder="Search across all columns..." style="padding-left:44px">
                </div>
                <div id="filterContainer" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px"></div>
            </div>

            <!-- History Panel -->
            <div id="historyPanel" class="glass hidden" style="border-radius:16px;box-shadow:0 8px 32px rgba(0,0,0,0.1);padding:24px;margin-bottom:24px;border:1px solid rgba(232,220,200,0.5)">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
                    <h3 style="font-size:20px;font-weight:700;color:#2C3E2F">Saved Files</h3>
                    <button id="clearHistoryBtn" style="color:#ef4444;font-size:14px;font-weight:500;padding:6px 12px;border:none;background:transparent;cursor:pointer;border-radius:6px;transition:all 0.2s">
                        Clear All
                    </button>
                </div>
                <div id="historyList" style="max-height:320px;overflow-y:auto"></div>
            </div>

            <!-- Empty State -->
            <div id="emptyState" class="glass" style="border-radius:16px;box-shadow:0 8px 32px rgba(0,0,0,0.1);padding:64px 32px;text-align:center;border:1px solid rgba(232,220,200,0.5)">
                <svg style="width:96px;height:96px;margin:0 auto 24px;color:#D4A574" class="pulse" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"/>
                </svg>
                <h2 style="font-size:28px;font-weight:700;color:#2C3E2F;margin-bottom:12px">No Data Yet</h2>
                <p style="color:#6D776E;margin-bottom:24px;font-size:18px">Upload an Excel file to start managing your data</p>
                <button id="emptyStateBtn" class="btn-primary" style="padding:16px 32px;font-size:18px">Choose File</button>
            </div>

            <!-- Card View -->
            <div id="cardViewContainer" class="hidden">
                <div class="glass" style="border-radius:16px;box-shadow:0 8px 32px rgba(0,0,0,0.1);padding:16px;margin-bottom:24px;border:1px solid rgba(232,220,200,0.5)">
                    <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px">
                        <div id="cardCounter" style="font-weight:700;color:#2C3E2F;display:flex;align-items:center;gap:8px">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#D4A574" stroke-width="2">
                                <rect x="2" y="3" width="20" height="18" rx="2"/><line x1="2" y1="9" x2="22" y2="9"/>
                            </svg>
                            Card 1 of 0
                        </div>
                        <div style="display:flex;gap:12px">
                            <button id="prevCard" class="btn-secondary" style="padding:10px 16px">‚Üê Previous</button>
                            <button id="deleteCard" class="btn-primary" style="background:#ef4444;padding:10px 16px">üóëÔ∏è Delete</button>
                            <button id="nextCard" class="btn-primary" style="padding:10px 16px">Next ‚Üí</button>
                        </div>
                    </div>
                </div>
                <div id="cardContent" class="glass" style="border-radius:16px;box-shadow:0 8px 32px rgba(0,0,0,0.1);padding:32px;border:1px solid rgba(232,220,200,0.5)"></div>
            </div>

            <!-- Table View -->
            <div id="tableView" class="glass hidden" style="border-radius:16px;box-shadow:0 8px 32px rgba(0,0,0,0.1);overflow:hidden;border:1px solid rgba(232,220,200,0.5)">
                <div style="overflow-x:auto">
                    <table>
                        <thead>
                            <tr id="tableHeader"></tr>
                        </thead>
                        <tbody id="tableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="/app.js"></script>
</body>
</html>
