<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Editor Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        *{font-family:'Inter',sans-serif;scrollbar-width:thin;scrollbar-color:#D4A574 #E8DCC8}
        *::-webkit-scrollbar{width:10px;height:10px}
        *::-webkit-scrollbar-track{background:#E8DCC8;border-radius:5px}
        *::-webkit-scrollbar-thumb{background:linear-gradient(135deg,#6D776E,#D4A574);border-radius:5px;border:2px solid #E8DCC8}
        .glass-effect{background:rgba(255,255,255,0.7);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px)}
        .animate-fade-in{animation:fadeIn 0.3s ease-out}
        @keyframes fadeIn{from{opacity:0}to{opacity:1}}
        .animate-slide-in{animation:slideIn 0.3s ease-out}
        @keyframes slideIn{from{transform:translateY(-20px);opacity:0}to{transform:translateY(0);opacity:1}}
        .suggestion-item{padding:10px 12px;cursor:pointer;transition:all 0.15s;border-bottom:1px solid #E8DCC8;display:flex;justify-content:space-between;align-items:center}
        .suggestion-item:last-child{border-bottom:none}
        .suggestion-item:hover{background:#FFF8EB;padding-left:16px}
        input[type="checkbox"]{accent-color:#D4A574}
        .japanese-pattern{background-image:repeating-linear-gradient(45deg,transparent,transparent 35px,rgba(212,165,116,0.03) 35px,rgba(212,165,116,0.03) 70px)}
    </style>
</head>
<body class="japanese-pattern">
    <div class="min-h-screen p-4 relative overflow-hidden">
        <div class="fixed inset-0 pointer-events-none opacity-5">
            <svg class="absolute top-10 right-10 w-64 h-64" viewBox="0 0 200 200">
                <circle cx="100" cy="40" r="35" fill="#D4A574"/>
                <path d="M30,120 Q50,80 70,120 T110,120 T150,120 T190,120" stroke="#6D776E" stroke-width="2" fill="none"/>
                <rect x="80" y="80" width="40" height="60" fill="#2C3E2F" opacity="0.8"/>
                <rect x="85" y="95" width="30" height="20" fill="#FFF8EB"/>
            </svg>
        </div>

        <div id="toastContainer" class="fixed top-6 right-6 z-50"></div>

        <div class="max-w-7xl mx-auto">
            <div class="glass-effect rounded-2xl shadow-2xl p-6 mb-6 border border-[#E8DCC8]">
                <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6">
                    <div class="flex items-center gap-4">
                        <svg class="w-12 h-12 text-[#D4A574]" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2"/>
                            <line x1="9" y1="3" x2="9" y2="21"/>
                            <line x1="15" y1="3" x2="15" y2="21"/>
                            <line x1="3" y1="9" x2="21" y2="9"/>
                            <line x1="3" y1="15" x2="21" y2="15"/>
                        </svg>
                        <div>
                            <h1 class="text-4xl font-bold bg-gradient-to-r from-[#6D776E] to-[#D4A574] bg-clip-text text-transparent">Excel Editor Pro</h1>
                            <p class="text-[#6D776E] font-medium">Professional Data Management System</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-3 flex-wrap">
                        <label class="flex items-center gap-2 px-4 py-2 glass-effect rounded-lg border border-[#E8DCC8] cursor-pointer hover:bg-white/80 transition-all">
                            <input type="checkbox" id="autoSave" checked class="rounded">
                            <span class="text-sm font-medium text-[#2C3E2F]">Auto-save</span>
                        </label>
                        <div class="inline-flex glass-effect rounded-xl p-1 border border-[#E8DCC8]">
                            <button id="tableViewBtn" class="px-4 py-2 rounded-lg font-medium transition-all bg-gradient-to-r from-[#6D776E] to-[#D4A574] text-white shadow-lg">
                                <svg class="inline-block w-4 h-4 mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/>
                                    <rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/>
                                </svg>Table
                            </button>
                            <button id="cardViewBtn" class="px-4 py-2 rounded-lg font-medium transition-all text-[#6D776E] hover:bg-white/50">
                                <svg class="inline-block w-4 h-4 mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="2" y="3" width="20" height="18" rx="2"/>
                                    <line x1="2" y1="9" x2="22" y2="9"/>
                                </svg>Card
                            </button>
                        </div>
                    </div>
                </div>
                <div class="flex flex-wrap gap-3">
                    <input type="file" id="fileInput" accept=".xlsx,.xls" class="hidden">
                    <button id="uploadBtn" class="px-6 py-3 bg-gradient-to-r from-[#6D776E] to-[#D4A574] text-white rounded-lg shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all font-medium">
                        <svg class="inline-block w-5 h-5 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"/>
                        </svg>Upload File
                    </button>
                    <button id="downloadBtn" disabled class="px-6 py-3 bg-white border-2 border-[#D4A574] text-[#6D776E] rounded-lg shadow hover:shadow-lg transform hover:-translate-y-0.5 transition-all font-medium disabled:opacity-50 disabled:cursor-not-allowed">
                        <svg class="inline-block w-5 h-5 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/>
                        </svg>Download
                    </button>
                    <button id="undoBtn" disabled class="px-4 py-3 bg-white border-2 border-[#E8DCC8] text-[#6D776E] rounded-lg hover:border-[#D4A574] transition-all disabled:opacity-50" title="Undo">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 7v6h6M21 17a9 9 0 00-9-9 9 9 0 00-9 9"/>
                        </svg>
                    </button>
                    <button id="redoBtn" disabled class="px-4 py-3 bg-white border-2 border-[#E8DCC8] text-[#6D776E] rounded-lg hover:border-[#D4A574] transition-all disabled:opacity-50" title="Redo">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 7v6h-6M3 17a9 9 0 019-9 9 9 0 019 9"/>
                        </svg>
                    </button>
                    <button id="addRowBtn" disabled class="px-6 py-3 bg-gradient-to-r from-[#D4A574] to-[#C19563] text-white rounded-lg shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all font-medium disabled:opacity-50">
                        <svg class="inline-block w-5 h-5 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
                        </svg>Add Row
                    </button>
                    <button id="historyBtn" class="px-6 py-3 bg-white border-2 border-[#E8DCC8] text-[#6D776E] rounded-lg hover:border-[#D4A574] transition-all font-medium">
                        <svg class="inline-block w-5 h-5 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 3v5h5M3.05 13A9 9 0 1 0 6 5.3L3 8"/>
                        </svg>Files
                    </button>
                </div>
            </div>

            <div id="filterSection" class="hidden glass-effect rounded-2xl shadow-xl p-4 mb-6 border border-[#E8DCC8] animate-fade-in">
                <div class="relative mb-4">
                    <svg class="absolute left-3 top-3 w-5 h-5 text-[#D4A574]" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
                    </svg>
                    <input type="text" id="globalSearch" placeholder="Search across all columns..." class="w-full pl-10 pr-4 py-3 glass-effect border-2 border-[#E8DCC8] rounded-xl focus:border-[#D4A574] focus:ring-2 focus:ring-[#D4A574]/20 transition-all outline-none">
                </div>
                <div id="filterContainer" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3"></div>
            </div>

            <div id="historyPanel" class="hidden glass-effect rounded-2xl shadow-xl p-6 mb-6 border border-[#E8DCC8] animate-slide-in">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-[#2C3E2F]">Saved Files</h3>
                    <button id="clearHistoryBtn" class="text-red-500 text-sm font-medium hover:text-red-700 px-3 py-1 hover:bg-red-50 rounded transition-all">Clear All</button>
                </div>
                <div id="historyList" class="space-y-3 max-h-80 overflow-y-auto"></div>
            </div>

            <div id="emptyState" class="glass-effect rounded-2xl shadow-2xl p-12 text-center border border-[#E8DCC8] animate-fade-in">
                <svg class="mx-auto w-24 h-24 text-[#D4A574] mb-6" style="animation:pulse 2s infinite" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"/>
                </svg>
                <h2 class="text-3xl font-bold text-[#2C3E2F] mb-3">No Data Yet</h2>
                <p class="text-[#6D776E] mb-6 text-lg">Upload an Excel file to start managing your data</p>
                <button id="emptyStateBtn" class="px-8 py-4 bg-gradient-to-r from-[#6D776E] to-[#D4A574] text-white rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all font-medium text-lg">Choose File</button>
            </div>

            <div id="cardViewContainer" class="hidden">
                <div class="glass-effect rounded-2xl shadow-xl p-4 mb-6 border border-[#E8DCC8]">
                    <div class="flex justify-between items-center">
                        <div id="cardCounter" class="text-[#2C3E2F] font-bold flex items-center gap-2">
                            <svg class="w-5 h-5 text-[#D4A574]" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="2" y="3" width="20" height="18" rx="2"/><line x1="2" y1="9" x2="22" y2="9"/>
                            </svg>
                            Card 1 of 0
                        </div>
                        <div class="flex gap-3">
                            <button id="prevCard" class="px-4 py-2 bg-white border-2 border-[#E8DCC8] text-[#6D776E] rounded-lg hover:border-[#D4A574] transition-all">‚Üê Previous</button>
                            <button id="deleteCard" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-all shadow-lg">üóëÔ∏è Delete</button>
                            <button id="nextCard" class="px-4 py-2 bg-gradient-to-r from-[#6D776E] to-[#D4A574] text-white rounded-lg hover:shadow-lg transition-all">Next ‚Üí</button>
                        </div>
                    </div>
                </div>
                <div id="cardContent" class="glass-effect rounded-2xl shadow-2xl p-8 border border-[#E8DCC8]"></div>
            </div>

            <div id="tableView" class="hidden glass-effect rounded-2xl shadow-2xl overflow-hidden border border-[#E8DCC8]">
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gradient-to-r from-[#6D776E] to-[#D4A574] text-white sticky top-0 z-10">
                            <tr id="tableHeader"></tr>
                        </thead>
                        <tbody id="tableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="/app.js"></script>
</body>
</html>
